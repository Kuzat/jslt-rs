{
  "name": "208_queens",
  "description": "Test case for the queens problem, ensuring that the solution correctly places queens on a chessboard without any attacks.",
  "program": "// ===========================================================================\n//  N-Queens problem solution in JSLT\n\n// board is n lists of length n\n//  0 => no queen\n//  1 => queen\n\n// queens(8) produces\n// [\n//   [ 1, 0, 0, 0, 0, 0, 0, 0 ],\n//   [ 0, 0, 0, 0, 1, 0, 0, 0 ],\n//   [ 0, 0, 0, 0, 0, 0, 0, 1 ],\n//   [ 0, 0, 0, 0, 0, 1, 0, 0 ],\n//   [ 0, 0, 1, 0, 0, 0, 0, 0 ],\n//   [ 0, 0, 0, 0, 0, 0, 1, 0 ],\n//   [ 0, 1, 0, 0, 0, 0, 0, 0 ],\n//   [ 0, 0, 0, 1, 0, 0, 0, 0 ]\n// ]\n\ndef queens(n)\n  solve(0, make-board($n))\n\ndef range(length, list)\n  if (size($list) < $length)\n    range($length, $list + [size($list)])\n  else\n    $list\n\ndef zeroes(length)\n  [for (range($length, [])) 0]\n\ndef make-board(n)\n  [for (range($n, [])) zeroes($n)]\n\ndef solve(row, board)\n  let n = size($board)\n  if ($row == $n)\n    $board\n  else\n    let tries = [for (range($n, []))\n      let newboard = place-queen($row, ., $board)\n      if (is-ok($newboard))\n        solve($row + 1, $newboard)\n      else\n        null]\n\n    filter($tries)[0]\n\ndef is-ok(board)\n  rows-ok($board) and cols-ok($board) and diagonals-ok($board)\n\ndef rows-ok(board)\n  all-ok([for ($board) sum(.) <= 1])\n\ndef cols-ok(board)\n  // 0, 1, 2, 3, ...\n  let indexes = range(size($board), [])\n\n  // list of columns instead of list of rows\n  let columns = [for ($indexes)\n    let col = (.)\n    [for ($board) .[$col]]\n  ]\n\n  rows-ok($columns)\n\ndef diagonals-ok(board)\n  let n = size($board)\n  let offsets = range($n - 1, [])[1 : ] // starts with 1\n\n  let diagonals-right = (\n    [diagonal-right($board, 0, 0)] +\n    [for ($offsets) diagonal-right($board, 0, .)] +\n    [for ($offsets) diagonal-right($board, ., 0)]\n  )\n\n  let diagonals-left = (\n    [diagonal-left($board, 0, $n - 1)] +\n    [for ($offsets) diagonal-left($board, ., $n - 1)] +\n    [for ($offsets) diagonal-left($board, 0, .)]\n  )\n\n  rows-ok($diagonals-right + $diagonals-left)\n\ndef diagonal-right(board, rowoff, coloff)\n  if ($rowoff >= size($board) or $coloff >= size($board))\n    []\n  else\n    [$board[$rowoff][$coloff]] + diagonal-right($board, $rowoff+1, $coloff+1)\n\ndef diagonal-left(board, rowoff, coloff)\n  if ($rowoff >= size($board) or $coloff < 0)\n    []\n  else\n    diagonal-left($board, $rowoff + 1, $coloff - 1) + [$board[$rowoff][$coloff]]\n\ndef sum(numbers)\n  if (not($numbers))\n    0\n  else\n    $numbers[0] + sum($numbers[1 : ])\n\ndef all-ok(booleans)\n  if (not($booleans))\n    true\n  else\n    $booleans[0] and all-ok($booleans[1 : ])\n\ndef place-queen(row, col, board)\n  let changerow = $board[$row]\n  let newrow = $changerow[ : $col] + [1] + $changerow[$col + 1 : ]\n\n  $board[ : $row] + [$newrow] + $board[$row + 1 : ]\n\ndef filter(array)\n  if (not($array))\n    []\n  else if ($array[0])\n    [$array[0]] + filter($array[1 : ])\n  else\n    filter($array[1 : ])\n\nqueens(8)",
  "input": {},
  "expected": [
    [
      1,
      0,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    [
      0,
      0,
      0,
      0,
      1,
      0,
      0,
      0
    ],
    [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      1
    ],
    [
      0,
      0,
      0,
      0,
      0,
      1,
      0,
      0
    ],
    [
      0,
      0,
      1,
      0,
      0,
      0,
      0,
      0
    ],
    [
      0,
      0,
      0,
      0,
      0,
      0,
      1,
      0
    ],
    [
      0,
      1,
      0,
      0,
      0,
      0,
      0,
      0
    ],
    [
      0,
      0,
      0,
      1,
      0,
      0,
      0,
      0
    ]
  ]
}
